jQuery(document).on("ready",(function(){$=jQuery,$(".wps_rma_return_notification").hide(),$("#wps_rma_return_request_form").on("submit",(function(e){e.preventDefault();var r=$(this).data("orderid"),_=$(".wps_rma_total_refund_price").val(),a="",o={},t=0,s="",n=wrael_common_param.check_pro_active,m=$("#wps_rma_return_request_subject").val();""!=m&&null!=m||""!=(m=$("#wps_rma_return_request_subject_text").val())&&null!=m&&m.match(/[[A-Za-z]/i)||(a+="<li>"+wrael_common_param.return_subject_msg+"</li>");var p=$(".wps_rma_return_request_reason").val();if(void 0===p||""!=p&&null!=p&&p.match(/[[A-Za-z]/i)||(a+="<li>"+wrael_common_param.return_reason_msg+"</li>"),n&&"function"==typeof wps_rma_return_alert_condition_addon){var c=wps_rma_return_alert_condition_addon();c&&(a+=c)}var i=wrael_common_param.refund_form_attachment;if(i&&"on"==i&&$(".wps_rma_return_request_files").each((function(){var e=$(this);if(e[0].files.length){var r=e[0].files[0].type;"image/png"==r||"image/jpeg"==r||"image/jpg"==r||(a+="<li>"+wrael_common_param.file_not_supported+"</li>")}else a+="<li>"+wrael_common_param.no_file_attached+"</li>"})),""!=a)return $("#wps_rma_return_alert").show(),$("#wps_rma_return_alert").html(a),$("#wps_rma_return_alert").addClass("woocommerce-error"),$("#wps_rma_return_alert").removeClass("woocommerce-message"),$("#wps_rma_return_alert").css("background-color","red"),$("html, body").animate({scrollTop:$("#wps_rma_return_request_container").offset().top},800),!1;if($("#wps_rma_return_alert").hide(),$("#wps_rma_return_alert").html(a),n){if("function"==typeof wps_rma_refund_total){var d=wps_rma_refund_total();o=d.selected_product,_=d.amount}}else $(".wps_rma_return_column").each((function(){if($(this).find("td:eq(0)").children(".wps_rma_return_product")){var e={},r=$(this).data("variationid"),_=$(this).data("productid"),a=$(this).data("itemid"),s=$(this).find("td:eq(0)").children(".wps_rma_product_amount").val(),n=$(this).find("td:eq(1)").children(".wps_rma_return_product_qty").val();e.product_id=_,e.variation_id=r,e.item_id=a,e.price=s,e.qty=n,o[t]=e,t++}}));n&&"function"==typeof wps_rma_refund_method&&(s=wps_rma_refund_method());var l={action:"wps_rma_save_return_request",products:o,amount:_,subject:m,reason:p,orderid:r,bankdetails:$("#wps_rma_bank_details").val(),refund_method:s,security_check:wrael_common_param.wps_rma_nonce},u=new FormData(this);u.append("action","wps_rma_return_upload_files"),u.append("security_check",wrael_common_param.wps_rma_nonce),$(".wps_rma_return_notification").show(),$.ajax({url:wrael_common_param.ajaxurl,type:"POST",data:u,contentType:!1,cache:!1,processData:!1,success:function(e){$.ajax({url:wrael_common_param.ajaxurl,type:"POST",data:l,dataType:"json",success:function(e){var _=10;setInterval((function(){_>=0&&$("#countdownTimer").html(_),_-=1}),1e3);$("#wps_rma_return_alert").removeClass("woocommerce-error"),$("#wps_rma_return_alert").addClass("woocommerce-message"),$("#wps_rma_return_alert").css("background-color","#8FAE1B"),$("#wps_rma_return_alert").show(),$("#wps_rma_return_alert").html(e.msg+' in <b><span id="countdownTimer"></span> seconds</b>'),$(".wps_rma_return_notification").hide(),$("html, body").animate({scrollTop:$("#wps_rma_return_request_container").offset().top},800),void 0!==e.auto_accept&&1==e.auto_accept?"function"==typeof wps_rma_refund_auto_accept&&wps_rma_refund_auto_accept(r):window.setTimeout((function(){window.location.href=wrael_common_param.myaccount_url}),11e3)}})}})})),$(document).on("click",".wps_remove_notice_msg",(function(e){e.preventDefault(),$(".wps_order_msg_notice_wrapper").hide()})),$(document).on("click","#wps_order_msg_submit",(function(e){e.preventDefault();var r=$("#wps_order_msg_attachment"),_=$("#wps_order_new_msg").val(),a=$("#order_msg_type").val(),o="",t=$(this).data("id"),s=new FormData,n=wrael_common_param.order_msg_attachment;if(n&&"on"==n&&r[0]){var m=r[0].files.length;if(m)for(var p=0;p<m;p++){var c=r[0].files[p].type;"image/png"==c||"image/jpeg"==c||"image/jpg"==c?s.append("wps_order_msg_attachment[]",r[0].files[p]):o='<p class="wps_order_msg_sent_notice">'+wrael_common_param.file_not_supported+'</p><a href="" class="wps_remove_notice_msg">X</a>'}}if(""==_&&(o='<p class="wps_order_msg_sent_notice">'+wrael_common_param.message_empty+'</p><a href="" class="wps_remove_notice_msg">X</a>'),o)return $(".wps_order_msg_notice_wrapper").css("display","flex"),$(".wps_order_msg_notice_wrapper").css("background-color","red"),$(".wps_order_msg_notice_wrapper").html(o),$("#wps_order_msg_submit").css({"outline-color":"white","border-color":"white"}),!1;s.append("action","wps_rma_order_messages_save"),s.append("msg",_),s.append("order_msg_type",a),s.append("order_id",t),s.append("security_check",wrael_common_param.wps_rma_nonce),$.ajax({url:wrael_common_param.ajaxurl,type:"post",data:s,dataType:"json",contentType:!1,processData:!1,success:function(e){if(e){var r='<p class="wps_order_msg_sent_notice">'+wrael_common_param.message_sent+'</p><a href="" class="wps_remove_notice_msg">X</a>';$(".wps_order_msg_notice_wrapper").css("background-color","#64CD83"),$(".wps_order_msg_notice_wrapper").css("display","flex"),$("#wps_order_msg_submit").css({"outline-color":"none","border-color":"none"}),$(".wps_order_msg_sub_container").load(document.URL+" .wps-order-msg__row"),$("#wps_order_new_msg").val(""),$("#wps_order_msg_attachment").val(""),$(".wps_order_msg_notice_wrapper").html(r)}}})})),$(".wps_order_msg_reload_notice_wrapper").hide(),$(document).on("click",".wps_reload_messages",(function(e){e.preventDefault(),$(this).addClass("wps-loader-icon"),$(".wps_order_msg_sub_container").load(document.URL+" .wps-order-msg__row"),setTimeout((function(){$(".wps_reload_messages").removeClass("wps-loader-icon"),$(".wps_order_msg_reload_notice_wrapper").show(),$(".wps_order_msg_reload_notice_wrapper").css({"background-color":"rgb(100, 205, 131)","border-radius":"5px",color:"white","padding-left":"10px"})}),2e3),setTimeout((function(){$(".wps_order_msg_reload_notice_wrapper").hide()}),3e3)})),$(document).on("click",".wps_order_send_msg_dismiss",(function(e){e.preventDefault(),$(".wps_order_msg_notice_wrapper").hide()}))}));